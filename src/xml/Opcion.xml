<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="opcion" >
  <resultMap id="Opcion" class="sigefirrhh.persistencia.modelo.Opcion" >
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Apr 21 15:12:33 VET 2015.
    -->
    <result column="id_opcion" property="idOpcion" jdbcType="INTEGER" />
    <result column="codigo_opcion" property="codigoOpcion" jdbcType="VARCHAR" />
    <result column="descripcion" property="descripcion" jdbcType="VARCHAR" />
    <result column="ruta" property="ruta" jdbcType="VARCHAR" />
    <result column="tipo" property="tipo" jdbcType="VARCHAR" />
    <result column="uri" property="uri" jdbcType="VARCHAR" />
    <result column="jerarquia" property="jerarquia" jdbcType="VARCHAR" />
  </resultMap>
  
  <select id="buscarOpcion" resultMap="Opcion" parameterClass="sigefirrhh.persistencia.modelo.CriterioBusqueda" >
    <!--realizado el 21-04-15 15:20:44 .-->
		SELECT id_opcion, codigo_opcion, descripcion, ruta, tipo, uri, jerarquia, estatus
			FROM opcion 
		where 
		jerarquia is not null and estatus = 'A'
    
	   <isParameterPresent >
	   		
			<isNotNull prepend="AND" property="uri" >
				<iterate property="uri" open="uri in (" close=")"	conjunction="," >
					#uri[]#
				</iterate>
			</isNotNull>
		
		</isParameterPresent>
   		 order by jerarquia
  </select> 
  
  
  <select id="buscarOpcionxRol" resultMap="Opcion" parameterClass="sigefirrhh.persistencia.modelo.CriterioBusqueda" >
    <!--realizado el 21-04-15 15:20:44 .-->
	    SELECT op.id_opcion, codigo_opcion, descripcion, ruta, tipo, uri, jerarquia
			FROM  public.rol, public.opcion op, public.rolopcion
			WHERE 
			  op.id_opcion = rolopcion.id_opcion AND
			  rolopcion.id_rol = rol.id_rol and
			  op.jerarquia is not null 
    
	   <isParameterPresent >
	  
			<isNotNull prepend="AND" property="idRol" >
				<iterate property="idRol" open="rol.id_rol in (" close=")"	conjunction="," >
					#idRol[]#
				</iterate>
			</isNotNull>
			
			<isNotNull prepend="AND" property="uri" >
				<iterate property="uri" open="uri in (" close=")"	conjunction="," >
					#uri[]#
				</iterate>
			</isNotNull>
		
		</isParameterPresent>
   		 order by op.jerarquia
  </select> 
</sqlMap>